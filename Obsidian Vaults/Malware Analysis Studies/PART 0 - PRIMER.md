## Goals of Malware Analysis:
- provide the information needed to respond to a network intrusion by determining what happened and to ensure you've located all infected machines and files
- determining exactly what a particular binary does
- how to detect a binary on a network
- how to measure and contain a binary's damage
- when identifying which files require analysis, it's important to develop signatures to detect infections on the network
- **host-based signatures** (also known as indicators), detect malicious code on victim computers. identify files created or modified by malware or any changes made in the system's registry. 
	- unlike antivirus signatures, *indicators focus on what malware done to a system, not the characteristics of malware itself.* makes them more effective in detecting malware that changes forms or malware that has been deleted off the disk. 
- **Network signatures** detect malware by monitoring network traffic. can be created without malware analysis. signatures made with malware analysis are usually much more effective, with lower false positive rates. 
- the final objective is to figure out exactly how the malware works

## Malware Analysis Techniques:
- two fundamental approaches: **static and dynamic**
	- **static analysis** - examining malware without running it
	- **dynamic analysis** - examining malware as it runs
	- both are categorized as either **basic or advanced**

### Basic Static Analysis:
- examining an executable without viewing the actual instructions
- can confirm whether a file is malicious
- provides information about file functionality
- sometimes provides basic information allowing simple network signatures
- straightforward and quick, but ineffective against sophisticated malware (misses important behaviors)

### Basic Dynamic Analysis:
- running malware and observing behavior on the system to:
	- remove infection
	- produce effective signatures
	- or both
- requires a safe environment that allows you to study the malware without risking damage to the system or network
- can be used by most without deep programming language
- won't be effective with all malware (misses important behaviors)

### Advanced Static Analysis:
- RevEng malware's internals by loading the .exe into a disassembler and looking at the instructions to understand what it does
	- instructions are executed by the CPU
- tells you exactly what the program does
- steeper learning curve than basic; requires knowledge of disassembly, code constructs, and windows OS concepts

### Advanced Dynamic Analysis:
- uses debugger to examine internal state of an exe
- analysis techniques provide another way to extract detailed information from exe; most useful when trying to obtain information difficult to obtain from other techniques

## Types of Malware:
- you can speed up your analysis by making educated guesses on what malware is trying to do and then confirming those hypotheses
- categories most malware falls into:


| Category     | Description                                                                                                                                                                                                                                                                                                                         |
| ------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Backdoor     | installs itself onto a computer to allow attacker access. Lets attacker connect to the computer with little to no authentication and allows command execution at a local level                                                                                                                                                      |
| Botnet       | similar to backdoor. All computers infected with the same botnet receive the same instructions from a command and control server (C2)                                                                                                                                                                                               |
| Downloader   | exists to only download malicious code. installed by attackers when they first gain access to a system. program downloads and then installs additional malware.                                                                                                                                                                     |
| Info-stealer | collects information from victim's device and sends credentials to the attacker. examples include: sniffers, password hash grabbers, keyloggers. Typically used to gain access to online accounts.                                                                                                                                  |
| Launcher     | program used to launch other malicious programs. usually have nontraditional techniques to launch other malicious programs to ensure stealth or greater access to the system                                                                                                                                                        |
| Rootkit      | malware designed to conceal the existence of other code. paired with other malware (such as backdoor), to allow remote access and make the code difficult for the victim to detected                                                                                                                                                |
| Scareware    | designed to scare the user into buying something. usually has an interface that makes it look like a security program. informs users that there is malware on their code and the only way to get rid of it is via the product it advertises. All the program does is remove the scareware itself and not any malware on the system. |
| Spam-sender  | infects user's machine and then uses that machine to send spam. generates income for attackers by allowing them to sell spam services                                                                                                                                                                                               |
| Worm/Virus   | malware that copies itself and infects other computers.                                                                                                                                                                                                                                                                             |
- malware can fall into multiple categories, as each component can fall into one of them.
	- example: a program using a keylogger component collecting passwords and a worm component that sends spam
- don't get caught up classifying malware according to its functionality
- malware can also be classified based on whether the attacker's objective is **mass or targeted**:
	- **Mass Malware**: takes the shotgun approach and tries to affect as many machines as possible. Most common and less sophisticated kind of malware
	- **Targeted Malware**: tailored to a specific individual/organization. bigger threat to networks than mass malware since it's not widespread and most security products may not have a way to protect organizations. without a detailed analysis, it's nearly impossible to protect the network. usually very sophisticated and analyzing it requires advanced analysis skills. 

## General Rules for Malware Analysis:
1. **Don't get caught up in the details** - most programs are large and complex. you won't understand all of the program. Focus on the key features. When you run into a difficult section, take a general look before you get stuck in the weeds.
2. **remember that different tools and approaches are available for different jobs** - every situation is different, and tools with overlapping functionalities might result in different outcomes. if you're not having much luck with one tool, try another one. if you're stuck on one issue, try another one. Analyze the malware from a different angle or a different approach. 
3. **malware analysis is a cat and mouse game** - new malware analysis techniques are always developed, and malware developers find other ways to circumvent them. to succeed as an analyst you need to be able to recognize, understand, and defeat the techniques and respond to the changes. 